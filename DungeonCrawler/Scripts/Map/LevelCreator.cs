using System;
using System.Collections.Generic;

namespace DungeonCrawler
{
    class LevelCreator
    {
        private Level[] levels = new Level[3];
        private Point[] spawnPoints = new Point[3];
        private readonly static Point level1SpawnPoint = new Point(1, 1);
        private readonly static Point level2SpawnPoint = new Point(14, 8);
        private readonly static Point level3SpawnPoint = new Point(1, 1);
        private static Random rnd = new Random();
        static readonly char[,] LevelOne = new char[,] {{ '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', '1', '-', '-', '-', '-', '-', '-', '-', '-', '-', 'b', '-', '#', 'p', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '.', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#', '#', 'B', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', 'P', '#', '#', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', 'y', '#' },
                                                        { '#', 'c', '-', '#', '2', '#', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' } };

        static readonly char[,] LevelTwo = new char[,] {{ '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', 'P', '-', '-', '-', '-', '-', '-', '-', '#', '2', '#' },
                                                        { '#', '#', '-', '#', '#', '#', '#', '#', '#', '#', '#', '#', '-', '#', '-', '#', '-', '#' },
                                                        { '#', '#', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '#', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '#', '-', '#', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '-', '#', '#', '-', '#', '#', '#', '-', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '#', '-', '#', '#', '#', '#', '#', '#', '#', '#', '#', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '#', '#', '#', '#', '-', '#', '#', '-', '#', '-', '-', '#' },
                                                        { '#', '-', '#', '#', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '#', '#', '#', '-', '#', '#', '#', '#', '#', '-', '#', '-', 'b', '#' },
                                                        { '#', '#', '#', '-', '#', '-', '#', '#', '#', '-', '-', '-', '#', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '#', '-', '#', 'y', '-', '#' },
                                                        { '#', '-', '#', '#', '-', '#', '#', '#', '#', '#', '#', '-', '#', '-', '#', '#', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '#', '1', '#', 'g', '-', '#', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '-', '#', '#', '-', '#', '#', '#', '#', '-', '#', '-', '#', '#' },
                                                        { '#', 'p', '-', 'B', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '#', '#' },
                                                        { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' } };

        static readonly char[,] LevelThree = new char[,]{{ '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', '1', '-', '-', '-', '-', '-', '-', '-', '-', '-', 'b', '-', '#', 'p', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#', '#', 'B', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', 'P', '#', '#', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '-', '#' },
                                                        { '#', 'c', '-', '#', 'G', '#', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' }
        };
        public static Level CreateLevel(char[,] charLayout, int amountOfEnemies)
        {
            Point entryDoor = new Point(0, 0);
            Point exitDoor = new Point(0,0);
            Point playerStartingPosition = new Point(0, 0);
            int levelHeight = charLayout.GetLength(0);
            int levelWidth = charLayout.GetLength(1);
            Tile[,] levelLayout = new Tile[levelHeight, levelWidth];
            List<GameObject> activeGameObjects = new List<GameObject>();

            for (int row = 0; row < levelHeight; row++)
            {
                for (int column = 0; column < levelWidth; column++)
                {
                    switch (charLayout[row, column])
                    {
                        case '#':
                            if (row == 0 || row == levelHeight - 1 || column == 0 || column == levelWidth - 1)
                                levelLayout[row, column] = new Wall(true);
                            else
                                levelLayout[row, column] = new Wall(false);
                            break;
                        case '-':
                            levelLayout[row, column] = new Floor();
                            break;
                        case 'P':
                            levelLayout[row, column] = new PurpleDoor();
                            break;
                        case 'B':
                            levelLayout[row, column] = new BlueDoor();
                            break;
                        case 'G':
                            levelLayout[row, column] = new ExitDoor(false);
                            break;
                        case '.':
                            levelLayout[row, column] = new PressurePlate(row, column);
                            break;
                        case 'y':
                            activeGameObjects.Add(new YellowKey(row, column));
                            levelLayout[row, column] = new Floor();
                            break;
                        case 'p':
                            activeGameObjects.Add(new PurpleKey(row, column));
                            levelLayout[row, column] = new Floor();
                            break;
                        case 'b':
                            activeGameObjects.Add(new BlueKey(row, column));
                            levelLayout[row, column] = new Floor();
                            break;
                        case 'g':
                            activeGameObjects.Add(new SkeletonKey(row, column));
                            levelLayout[row, column] = new Floor();
                            break;
                        case 'c':
                            activeGameObjects.Add(new Potion(row, column));
                            levelLayout[row, column] = new Floor();
                            break;
                        case '1':
                            entryDoor = new Point(row, column);
                            playerStartingPosition = new Point(row, column);
                            levelLayout[row, column] = new YellowDoor(true);
                            break;
                        case '2':
                            exitDoor = new Point(row, column);
                            levelLayout[row, column] = new YellowDoor(false);
                            break;
                        default:
                            levelLayout[row, column] = new Floor();
                            break;
                    }
                }
            }
            for (int i = 0; i < amountOfEnemies; i++)
            {
                activeGameObjects.Add(new Enemy(CreateRandomPoint(levelHeight - 2, levelWidth - 2)));
            }
            return new Level(levelLayout, activeGameObjects, playerStartingPosition, amountOfEnemies, entryDoor, exitDoor);
        }
        private static Point CreateRandomPoint(int x, int y)
        {
            return new Point(rnd.Next(1, x), rnd.Next(1, y));
        }
        public static Level[] GetLevels()
        {
            Level[] levelsToReturn = new Level[3];
            levelsToReturn[0] = CreateLevel(LevelOne, 5);
            levelsToReturn[1] = CreateLevel(LevelTwo, 0);
            levelsToReturn[2] = CreateLevel(LevelThree, 10);
            return levelsToReturn;
        }
    }
}



