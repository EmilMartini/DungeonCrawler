using System;
using System.Collections.Generic;

namespace DungeonCrawler
{
    class LevelCreator
    {
        private Level[] levels = new Level[3];
        private Point[] spawnPoints = new Point[3];
        private readonly static Point level1SpawnPoint = new Point(1, 1);
        private readonly static Point level2SpawnPoint = new Point(14, 8);
        private readonly static Point level3SpawnPoint = new Point(1, 1);
        private Random rnd = new Random();
        readonly char[,] LevelOne = new char[,] {       { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', 'E', '-', '-', '-', '-', '-', '-', '-', '-', '-', 'b', '-', '#', 'p', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '.', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#', '#', 'B', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', 'P', '#', '#', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', 'y', '#' },
                                                        { '#', 'c', '-', '#', 'Y', '#', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' } };
        readonly char[,] LevelTwo = new char[,] {       { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', 'P', '-', '-', '-', '-', '-', '-', '-', '#', 'Y', '#' },
                                                        { '#', '#', '-', '#', '#', '#', '#', '#', '#', '#', '#', '#', '-', '#', '-', '#', '-', '#' },
                                                        { '#', '#', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '#', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '#', '-', '#', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '-', '#', '#', '-', '#', '#', '#', '-', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '#', '-', '#', '#', '#', '#', '#', '#', '#', '#', '#', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '#', '#', '#', '#', '-', '#', '#', '-', '#', '-', '-', '#' },
                                                        { '#', '-', '#', '#', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '.', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '#', '#', '#', '-', '#', '#', '#', '#', '#', '-', '#', '-', 'b', '#' },
                                                        { '#', '#', '#', '-', '#', '-', '#', '#', '#', '-', '-', '-', '#', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '#', '-', '#', 'y', '-', '#' },
                                                        { '#', '-', '#', '#', '-', '#', '#', '#', '#', '#', '#', '-', '#', '-', '#', '#', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '#', 'Y', '#', 'g', '-', '#', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '-', '#', '#', '-', '#', '#', '#', '#', '-', '#', '-', '#', '#' },
                                                        { '#', 'p', '-', 'B', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '#', '#' },
                                                        { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' } };
        readonly char[,] LevelThree = new char[,] {       { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' },
                                                        { '#', 'E', '-', '-', '-', '-', '-', '-', '-', '-', '-', 'b', '-', '#', 'p', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '.', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#', '#', 'B', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', 'P', '#', '#', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', '#', '#' },
                                                        { '#', '-', '-', '-', '-', '-', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#', '#', 'y', '#' },
                                                        { '#', 'c', '-', '#', 'Y', '#', '-', '-', '-', '#', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '-', '#' },
                                                        { '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#', '#' }
        };
        public LevelCreator()
        {
            Level level1 = CreateLevel(LevelOne, 8);
            Level level2 = CreateLevel(LevelTwo, 0);
            Level level3 = CreateLevel(LevelThree, 10);
        }
        public Level CreateLevel(char[,] charLayout, int amountOfEnemies)
        {
            List<GameObject> activeGameObjects = new List<GameObject>();
            int levelHeight = charLayout.GetLength(0);
            int levelWidth = charLayout.GetLength(1);
            Tile[,] levelLayout = new Tile[levelHeight, levelWidth];
            Point playerStartingPosition = new Point(0, 0);
            for (int row = 0; row < levelHeight; row++)
            {
                for (int column = 0; column < levelWidth; column++)
                {
                    switch (charLayout[row, column])
                    {
                        case '#':
                            if (row == 0 || row == levelHeight - 1 || column == 0 || column == levelWidth - 1)
                            {
                                levelLayout[row, column] = new Wall(true);
                            }
                            else
                            {
                                levelLayout[row, column] = new Wall(false);
                            }
                            break;
                        case '-':
                            levelLayout[row, column] = new Floor();
                            break;
                        case 'Y':
                            levelLayout[row, column] = new YellowDoor(false);
                            break;
                        case 'P':
                            levelLayout[row, column] = new PurpleDoor();
                            break;
                        case 'B':
                            levelLayout[row, column] = new BlueDoor();
                            break;
                        case 'G':
                            levelLayout[row, column] = new ExitDoor(false);
                            break;
                        case '.':
                            levelLayout[row, column] = new PressurePlate(row, column);
                            break;
                        case '@':
                            playerStartingPosition = new Point(row, column);
                            break;
                        case 'y':
                            activeGameObjects.Add(new YellowKey(row, column));
                            break;
                        case 'p':
                            activeGameObjects.Add(new PurpleKey(row, column));
                            break;
                        case 'b':
                            activeGameObjects.Add(new BlueKey(row, column));
                            break;
                        case 'g':
                            activeGameObjects.Add(new SkeletonKey(row, column));
                            break;
                        case 'c':
                            activeGameObjects.Add(new Potion(row, column));
                            break;
                        default:
                            break;
                    }
                }
            }
            for (int i = 0; i < amountOfEnemies; i++)
            {
                activeGameObjects.Add(new Enemy(CreateRandomPoint(levelHeight - 2, levelWidth - 2)));
            }
            return new Level(levelLayout, activeGameObjects, playerStartingPosition, amountOfEnemies);
        }
        private Point CreateRandomPoint(int x, int y)
        {
            return new Point(rnd.Next(1, x), rnd.Next(1, y));
        }
    }
}



